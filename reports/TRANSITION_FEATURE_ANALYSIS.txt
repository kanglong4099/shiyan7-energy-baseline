================================================================================
         冷机加减机特征优化分析报告
================================================================================

生成时间: 2025-01-04

================================================================================
一、背景
================================================================================

问题假设:
  冷机加减机时的数据不稳定，添加加减机标记可能提高模型精度

解决方案:
  在v3.0基础上添加3个加减机相关特征:
    1. is_chiller_transition: 是否在加减机时刻
    2. is_transition_period: 是否在加减机过渡期（前后2小时）
    3. hours_since_transition: 距离最近一次加减机的小时数

================================================================================
二、冷机加减机分析（训练数据1-7月）
================================================================================

加减机统计:
  - 加减机总次数: 25次
  - 过渡期数据量: 117条 (2.5%)
  - 最少运行冷机数: 1台
  - 最多运行冷机数: 5台
  - 平均运行冷机数: 2.02台

能耗波动:
  - 加减机时刻平均能耗波动: 28.36%
  - 最大波动: 553.36% (从536kW跳变到3502kW)
  - 中位数波动: 4.89%
  - 波动>10%: 6次 (24.0%)
  - 波动>20%: 2次 (8.0%)

结论: 加减机时刻确实存在明显能耗波动

================================================================================
三、模型训练结果（测试集）
================================================================================

v3.0 (最终版本，10个特征）:
  R²: 0.9897
  RMSE: 88.53 kW
  MAE: 48.53 kW
  MAPE: 2.55%

v3.1 (含加减机标记，13个特征）:
  R²: 0.9927
  RMSE: 74.20 kW
  MAE: 37.57 kW
  MAPE: 2.05%

性能提升:
  R²提升: 0.0030 (0.30%)
  RMSE降低: 14.33 kW (16.2%)
  MAE降低: 10.96 kW (22.6%)
  MAPE降低: 0.50个百分点 (19.6%)

新增特征贡献:
  - is_chiller_transition: 0.00% ⚠️ 无贡献
  - is_transition_period: 0.02% ⚠️ 几乎无贡献
  - hours_since_transition: 1.05% ✓ 有贡献

特征重要性变化:
  - load_group: 56.53% → 39.90% (下降)
  - total_chiller_load: 20.47% → 30.35% (上升)
  - dew_point: 10.36% → 15.19% (上升)

结论: v3.1在测试集上性能显著优于v3.0

================================================================================
四、12月预测精度对比
================================================================================

小时级别:
  v3.0: R²=-0.0587, MAPE=3.85%
  v3.1: R²=-0.0482, MAPE=4.00%
  差异: MAPE增加0.15个百分点 (变差)

天级别:
  v3.0: R²=0.9764, MAPE=1.65%
  v3.1: R²=0.9509, MAPE=2.81%
  差异: MAPE增加1.16个百分点 (变差)

月级别:
  v3.0: MAPE=0.17%
  v3.1: MAPE=2.11%
  差异: MAPE增加1.95个百分点 (变差)

结论: v3.1在12月预测中性能显著低于v3.0

================================================================================
五、原因分析
================================================================================

训练数据vs 12月数据对比:

训练数据（1-7月）:
  - 平均运行冷机数: 2.02台
  - 最多运行冷机数: 5台
  - 负荷范围较宽

12月数据:
  - 平均运行冷机数: 1.93台
  - 最多运行冷机数: 3台
  - 负荷范围较窄

问题根源:
  1. 训练数据和12月数据的冷机运行模式不同
  2. hours_since_transition特征的含义在不同负荷区间下不一致
  3. 模型过拟合了训练集中的加减机模式
  4. 新增特征在12月数据上引入了噪声而非有用信息

具体表现:
  - hours_since_transition在训练集上有1.05%的贡献
  - 但这个贡献是基于2-5台冷机的加减机模式
  - 12月主要是1-3台冷机，模式完全不同
  - 导致模型在12月预测时受到错误信号的干扰

================================================================================
六、结论与建议
================================================================================

结论:
  ✓ 训练集性能提升: v3.1优于v3.0
  ✗ 12月预测性能下降: v3.1劣于v3.0
  ✗ 新增特征在实际预测中引入噪声
  ✗ 模型存在过拟合问题

根本原因:
  训练数据（1-7月）和预测数据（12月）的冷机运行模式存在显著差异，
  导致基于训练数据训练的加减机特征在12月预测中产生负作用。

建议:

1. 短期（当前阶段）:
   ✓ 继续使用v3.0版本（不含加减机标记）
   ✓ v3.0在测试集和12月预测中表现一致且良好

2. 中期（数据积累）:
   ✓ 收集全年的BMS数据，包含不同季节的加减机模式
   ✓ 分析全年的冷机运行策略差异
   ✓ 如果发现加减机模式全年一致，可以重新训练v3.1

3. 长期（模型优化）:
   ✓ 考虑按负荷区间分别训练模型（例如：低负荷、中负荷、高负荷）
   ✓ 增加更多与冷机运行策略相关的特征（如：台数、运行时长等）
   ✓ 使用时序模型（如LSTM）捕捉加减机的动态影响

================================================================================
七、最终推荐
================================================================================

推荐版本: v3.0 (最终版本）

推荐理由:
  1. 测试集性能良好 (MAPE=2.55%)
  2. 12月预测精度良好:
     - 小时级别: MAPE=3.85% ✓
     - 天级别: MAPE=1.65% ✓ 优秀
     - 月级别: MAPE=0.17% ✓ 优秀
  3. 性能稳定: 测试集和实际预测表现一致
  4. 特征简洁: 仅10个特征，物理意义清晰
  5. 可全年预测: 不含month特征，适合全年使用

不推荐v3.1的原因:
  1. 虽然测试集性能更好，但存在过拟合
  2. 12月预测精度明显下降
  3. 新增特征在实际预测中引入噪声
  4. 训练数据和预测数据模式不一致

================================================================================
报告生成完成
================================================================================
